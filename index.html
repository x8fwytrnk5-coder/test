<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Taxi Dispatch App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f5f5;
    }

    #top-panel {
      margin-bottom: 20px;
    }

    #top-panel button {
      margin-right: 10px;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      cursor: pointer;
    }

    #fare-panel {
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(255,255,255,0.3);
      border-radius: 10px;
    }

    #results-panel ul {
      list-style: none;
      padding: 0;
    }

    #results-panel li {
      margin: 5px 0;
      padding: 8px;
      background: #fff;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Horný panel -->
  <div id="top-panel">
    <button id="btn-accommodation">Ubytovanie</button>
    <button id="btn-restaurants">Reštaurácie</button>
    <button id="btn-culture">Kultúrne miesta</button>
  </div>

  <!-- Panel na výpočet ceny jazdného -->
  <div id="fare-panel">
    <label>Vzdialenosť (km): <input type="number" id="distance"></label>
    <label>Čas (min): <input type="number" id="time"></label>
    <button id="btn-fare">Spočítať cenu</button>
    <div id="fare-result"></div>
  </div>

  <!-- Panel na výsledky -->
  <div id="results-panel"></div>

  <script>
    // === Event listenery pre nové tlačidlá ===
    document.getElementById("btn-accommodation").addEventListener("click", () => {
      searchPlaces("hotel");
    });

    document.getElementById("btn-restaurants").addEventListener("click", () => {
      searchPlaces("restaurant");
    });

    document.getElementById("btn-culture").addEventListener("click", () => {
      searchPlaces("museum OR monument OR gallery");
    });

    // === Funkcia na vyhľadávanie miest cez OSM ===
    function searchPlaces(query) {
      if (!navigator.geolocation) {
        alert("GPS poloha nie je dostupná.");
        return;
      }
      navigator.geolocation.getCurrentPosition(pos => {
        const { latitude, longitude } = pos.coords;
        const url = `https://nominatim.openstreetmap.org/search?format=json&q=${query}&limit=10&bounded=1&viewbox=${longitude-0.05},${latitude+0.05},${longitude+0.05},${latitude-0.05}`;
        
        fetch(url)
          .then(res => res.json())
          .then(data => {
            displayResults(data);
          });
      });
    }

    // === Výpis výsledkov do zoznamu ===
    function displayResults(data) {
      const panel = document.getElementById("results-panel");
      panel.innerHTML = ""; // vyčisti staré výsledky
      const list = document.createElement("ul");
      data.forEach(place => {
        const li = document.createElement("li");
        li.textContent = place.display_name;
        li.addEventListener("click", () => {
          window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(place.display_name)}`, "_blank");
        });
        list.appendChild(li);
      });
      panel.appendChild(list);
    }

    // === Výpočet ceny jazdného ===
    document.getElementById("btn-fare").addEventListener("click", () => {
      const distance = parseFloat(document.getElementById("distance").value);
      const time = parseFloat(document.getElementById("time").value);

      const baseFare = 2.00; // základná taxa
      const perKm = 0.75;    // cena za km
      const perMin = 0.25;   // cena za minútu

      const total = baseFare + (distance * perKm) + (time * perMin);
      document.getElementById("fare-result").textContent = `Cena jazdy: €${total.toFixed(2)}`;
    });

    // === Automatické zobrazenie trasy pri spustení časovača ===
    function startRideTimer() {
      // ... existujúca logika časovača ...

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          const { latitude, longitude } = pos.coords;
          const mapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${latitude},${longitude}`;
          
          if (confirm("Chceš spustiť navigáciu v Google Maps?")) {
            window.open(mapsUrl, "_blank");
          }
        });
      }
    }
  </script>
</body>
</html>
